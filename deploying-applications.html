<!doctype html>
<html>
  <head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <title>Deploying Applications</title>
    <link rel="stylesheet" href="stylesheets/styles.css">
    <link rel="stylesheet" href="stylesheets/pygment_trac.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.7.1/jquery.min.js"></script>
    <script src="javascripts/main.js"></script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no">

  </head>
  <body>

      <header>
        <h1>Deploying jPregel Applications</h1>
        <p>A tutorial introduction</p>
      </header>

      <div id="banner">
        <span id="logo"></span>

        <a href="https://github.com/charlesmunger/jpregel-aws" class="button fork"><strong>View On GitHub</strong></a>
        <div class="downloads">
          <span>Download:</span>
          <ul>
            <!--<li><a href="https://github.com/charlesmunger/jpregel-aws/zipball/master" class="button">ZIP</a></li> -->
            <li><a href="https://github.com/charlesmunger/jpregel-aws/tarball/master" class="button">JAR</a></li>
          </ul>
        </div>
      </div><!-- end banner -->

    <div class="wrapper">
      <nav>
        <ul>
	        <li><a href="index.html"><img src="images/Home24.gif" /></a></li>
        	<li><a href="javadoc-api/index.html" target="parent">API</a></li>
			<li><a href="tutorial.html">Tutorial</a></li>
        </ul>
      </nav>
      <section>
	
	<h1>Deploying Applications</h1>
	
	<p><img src="images/merlin.gif" alt="merlin with student" width="400" /></p>
	
	<h2>Table of Contents</h2>
	<ol>
		<li>Deploying on 1 machine</li>
		<li>Deploying on a Local Area Network (LAN)</li>
		<li>
			<a href="#AWS">Deploying on Amazon Web Services (AWS)</a>
			<ol>
				<li><a href="#Initial-set-up">Initial set up</a></li>
				<li><a href="#Start-an-application">Starting a jpregel client on EC2</a></li>
			</ol>
		</li>
	</ol>

	<hr>
	
	<h2><a name="AWS">Deploying on Amazon Web Services (AWS)</a></h2>
	
	<p>
		Our deployment strategy entails an <i>Initial set up</i>: launching an AWS micro-instance as a client: 
		It will send the jpregel Master jobs to perform.
		Once launched, you will stop the client when you are finished with a jpregel job. 
		You <i>never terminate the client instance</i>.
		Instead, when you want to run another job, perhaps many days later, you begin by starting the client instance.
		The sequence of steps to run a job from your client is much shorter than the sequence to launch the client instance.
		We do endeavor to keep both of these instruction sequences as short as possible.
	</p>
	
	<h3><a name="Initial-set-up">Initial set up</a></h3>
	
	<p>The initial set up of your AWS deployment environment consists of the following steps:</p>
	
	<ol>
		<li>Create a free GitHub account.</li>
		<li>Create a GitHub repository for jpregel-aws.</li>
		<li>Create an AWS account.</li>
		<li>Create a file with your AWS jpregel-aws access key.</li>
		<li>Launch an instance that serves as a jpregel-aws client.</li>
	</ol>
	
	<p>We now explain how to perform these steps.</p>
	
	<ol>
		<li><h4>Create a free GitHub account</h4>
			<p>
				If you do not have a GitHub account, please create one. 
				Rather than repeat the explanation here, please see <a href="https://github.com/signup/free" target="parent">the GitHub explanation for creating a free account.</a>
			</p>
		</li>
		
		<li>
			<h4>Create a GitHub repository for jpregel-aws</h4>
			<p>
				Using your web browser, go to <a href="https://github.com/PeterCappello/jpregel-aws" target="parent">https://github.com/PeterCappello/jpregel-aws</a>.
				Click the <b>Fork</b> button in the upper right part of the page.
				A screen fragment of the web page is given below.
			</p>
			<p>
				<img src="images/ScreenShotFork-jpregel-awsRepository.png" alt="fork button on GitHub repository" width="600" />
			</p>
			<p>You now have your own copy of the jpregel-aws repository.
		</li>
		
		<li>
			<h4>Create an AWS account</h4>
			<p>
				Using your web browser, go to 
				<a href="http://docs.amazonwebservices.com/AWSEC2/latest/GettingStartedGuide/SignUp.html" target="parent">The latest AWS EC2 Getting Started Guide</a>.
				You will see that getting started entails 4 steps.
			</p>
			<p>
				<img src="images/ScreenShotEc2GettingStartedSteps.png" alt="EC2 Getting Started steps." width="600" />
			</p>
			<p>
				Here, we are interested in the first 2 steps: 
				<ol>
					<li>Sign up for EC2</li>
					<li>Launch instance</li>
				</ol>
			</p>
			<p>
				To sign up for EC2, create an AWS account:
				<ol>
					<li>Go to <a href="http://aws.amazon.com" target="parent">http://aws.amazon.com</a>, and click <b>Create an AWS Account</b>.</li>
					<li>Follow the on-screen instructions.</li>
				</ol>
				Part of the sign-up procedure involves receiving a phone call and entering a PIN using the phone keypad.
				When you create an account, AWS automatically signs up the account for all services. 
				You are charged only for the services that you use.
			</p>			
		</li>
		
		<li>
			<h4>Create a file with your jpregel AWS access keys.</h4>
			<p>
				Running a jpregel job first entails instantiating a Master machine and a set of Worker machines.
				To do this, you need a jpregel access key.
				Here is how to create a file with this key.
			</p>
			<ol>
				<li>Sign in to your AWS account.</li>
				<li>In the upper right hand corner of the page, you will see your name. Click on it, which generates a drop-down menu.</li>
				<li>Click on the <b>Security Credentials</b> entry.</li>
				<li>On that page, click on the Access Credentials link.</li>
				<li>Under the Access Credentials section, click on <b>Create a new Access Key</b>.</li>
				<li></li>
			</ol>
		</li>
				
		<li>
			<h4>Launch an instance</h4>
			<p>Now launch an instance that subsequently will serve as a jpregel-aws client.
				<ol>
					<li>Go to 
						<a href="http://docs.amazonwebservices.com/AWSEC2/latest/GettingStartedGuide/LaunchInstance.html" target="parent">
							Getting Started: Launch Instance instructions.
						</a>
					</li>
					<li>Follow the on-screen instructions.
						<ol>
							<li>Name the instance something meaningful, such as "jpregel client."</li>
							<li>Create a key pair, naming it "jpregel".</li>
							<li>Download the private part of the key pair and store it somewhere safe.</li>
							<li>For Launch Configuration, select the Amazon Linux, 64-bit option.</li>
							<li>Click <b>Continue</b>.</li>
						</ol>
					</li>
					<li>Launch the instance, executing the following Unix commands:
						<ol>
							<li>chmod 400 jpregel.pem (make sure your private key is not publicly viewable)</li>
							<li>ssh -i jpregel.pem ec2-user@publicDNS, where publicDNS is the public domain name of your instance.</li>
							<li>sudo yum install git</li>
							<li>git clone (url of your jpregel repository)</li>
							<li>./deploy.sh</li>
							<!--
							<li>export ANT_HOME=/home/ec2-user/jpregel-aws/Client-Resources/apache-ant-1.8.4</li>
							<li>export PATH=$PATH:/home/ec2-user/jpregel-aws/Client-Resources/apache-ant-1.8.4/bin</li>
							<li>echo export ANT_HOME=/home/ec2-user/jpregel-aws/Client-Resources/apache-ant-1.8.4 >> ~/.bashrc</li>
							<li>echo export PATH=$PATH:/home/ec2-user/jpregel-aws/Client-Resources/apache-ant-1.8.4/bin >> ~/.bashrc</li>
							-->
							<li>scp -i jpregel.pem key.AWSkey</li>
						</ol>
					</li>
				</ol>
			</p>
			<p>At this point you have a running jpregel client.
				<b>Stop</b> it, but do not <b>terminate</b> it. 
			</p>
			<p>
				When you want to deploy a jpregel job on EC2, you will start this client instance.
				Stop it when you are done.
				If you terminate it, you must create another instance using the steps above.	
			</p>		
		</li>
	</ol>
	
	<h3><a name="Start-an-application">Start a jpregel application on AWS</a></h3>
	
<!--
	
	<a name="Deploying-Applications"><h2>Deploying jPregel Applications</h2></a>
	<!--
	<h3>Deploying on a single machine</h3>
	
	<h3>Deploying on a local cluster</h3>
	
	<h3>Deploying on Amazon Web Services</h3>
	
	<ol>
		<li>Deploying with AWS
			<ol>
				<li>Setting up to deploy
					<ol>
						<li>Create an Amazon Web Services account. This requires a credit card.</li>
						<li>Create two SSH key pairs, named "privatekey" and "masterkey".</li>
						<li>Save these into privatekey.pem and masterkey.pem, in the jpregel-aws directory.</li>
						<li>Create a file named key.AWSkey, with your access key on the first line and your secret key on the second.</li>
					</ol>
				</li>
				<li>Deploying
					<ol>
						<li>From a Nebeans confirguration
							<ol>
								<li>
									<p>Specify a Main file with ant:</p>
									<p>ant run -propertyfile nbproject/configs/ShortestPath.properties -Dapplication.args="foobucket 10 10"</p>
								</li>
							</ol>
					</ol>
				</li>
			</ol>
		</li>
	</ol>
	
	
	<a name="Contributing-to-the-jpregel-project"><h2>Contributing to jPregel</h2></a>
-->
      </section>
      <footer>
        <p>Project maintained by <a href="https://github.com/charlesmunger">charlesmunger</a></p>
        <p><small>Hosted on GitHub Pages &mdash; Theme by <a href="http://twitter.com/#!/michigangraham">mattgraham</a></small></p>
      </footer>
    </div>
    <!--[if !IE]><script>fixScale(document);</script><![endif]-->
    
  </body>
</html>